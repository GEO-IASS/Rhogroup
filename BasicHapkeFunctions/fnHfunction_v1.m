function H_mu = fnHfunction_v1(w, mu);
%%
%fnHfunction_v1.m
% This function calculates the Chandrashekar H-Function used in the Hapke 
%Model from proposal
%----------------------------------------------------------------------------------------------------%
% INPUT
%----------------------------------------------------------------------------------------------------%
% w      : - single scattering albedo
% mu0 : - cosine of the incidence angle
%----------------------------------------------------------------------------------------------------%
% OUTPUT
%----------------------------------------------------------------------------------------------------%
% H_mu : - the H-Function output
%----------------------------------------------------------------------------------------------------%
%
%
% Reference : - "Theory of Reflectance and Emittance Spectroscopy", Bruce 
%                           Hapke, ISBN: 9780521883498
%
%
% Author's Name : - Arun M Saranathan
% Date                  : - 01/23/2014
%----------------------------------------------------------------------------------------------------%%----------------------------------------------------------------------------------------------------%
%%
r0 = (1-sqrt(1-w))/(1+sqrt(1-w));

H_mu = 1/ ( 1 - w*mu *(r0 + ( (1-2*r0*mu)/2) * log((1+mu)/mu) ) );

return